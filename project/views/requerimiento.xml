<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ==================== Listado / Tree ====================  -->
    <record id="project_requerimiento_tree" model="ir.ui.view">
        <field name="name">project.requerimiento.tree</field>
        <field name="model">project.requerimiento</field>
        <field name="arch" type="xml">
            <tree decoration-info="state=='borrador'" decoration-primary="state=='radicado'" decoration-success="state=='aprobado'">           
                <field name="name"/>
                <field name="titulo"/>
                <field name="project_id"/>
                <field name="create_date" string="Fecha Inicial"/>
                <field name="fecha_limite"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <!-- ==================== Listado / Kanban ====================  -->
    <record model="ir.ui.view" id="project_requerimiento_kanban">
        <field name="name">project.requerimiento.kanban</field>
        <field name="model">project.requerimiento</field>
        <field name="arch" type="xml">
            <kanban class="oe_background_grey o_kanban_dashboard o_project_kanban o_emphasize_colors">
                <field name="name"/>
                <field name="titulo"/>
                <field name="project_id"/>
                <field name="director_id"/>
                <field name="lider_id"/>
                <field name="gestor_id"/>
                <field name="color"/>
                <templates>
                <t t-name="kanban-box">
                    <div t-attf-class="#{kanban_color(record.color.raw_value)} oe_kanban_global_click o_has_icon">
                    <!-- <div t-attf-class="oe_kanban_global_click o_has_icon"> -->
                        <div class="o_project_kanban_main">
                            <div class="o_kanban_card_content">
                                <div class="o_kanban_record_top" style="font-size: 15px;"> 
                                    <div class="o_kanban_record_headings">
                                        <strong>[<field name="name"/>]: </strong><span><field name="titulo"/></span>
                                        <div style="height: 5px;"></div>            
                                        <b>Proyecto: </b> <span><field name="project_id"/></span>
                                    </div>
                                </div>
                                <div class="" style="color: #7C7BAD;margin-top: 10px;font-size: 12px;">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td><b>Director: </b></td>
                                                <td><field name="director_id"/></td>
                                            </tr>
                                            <tr>
                                                <td><b>Líder: </b></td>
                                                <td><field name="lider_id"/></td>
                                            </tr>
                                            <tr>
                                                <td><b>Gestor: </b></td>
                                                <td><field name="gestor_id"/></td>
                                            </tr>                                        
                                        </tbody>
                                    </table>                                                                
                                </div>
                            </div>
                            <div class="o_kanban_card_manage_pane dropdown-menu" role="menu">
                                <div class="o_kanban_card_manage_section o_kanban_manage_reports">
                                    <div role="menuitem">
                                        <a type="edit">Edit</a>
                                    </div>
                                </div>
                            </div>                            
                        </div>
                    </div>
                </t>
                </templates>
            </kanban>
        </field>
    </record>    

   
    <!-- ==================== Formulario (Radicado) ==================== -->
    <record id="project_requerimiento_radicado" model="ir.ui.view">
        <field name="name">project.requerimiento.form</field>
        <field name="model">project.requerimiento</field>
        <field name="arch" type="xml">
            <form string="Requerimientos">
                <header>
                    <button name="btn_send_email" string="Enviar correo" type="action" class="oe_highlight oe_edit_only"/>
                    <button id="button_confirmar" name="action_radicar" string="Radicar" class="btn-primary" states="borrador"
                        confirm="¿Estás seguro(a) que desea radicar el requerimiento?" 
                        type="object"
                    />

                    <button id="button_hecho" name="action_aprobar" string="Aprobar" class="btn-primary" states="radicado"
                        confirm="¿Estás seguro(a) que desea aprobar el requerimiento?"
                        type="object"
                    />

                    <button id="button_borrador" name="action_borrador" string="Establecer a borrador" class="btn-primary" states="cancelado"
                        type="object"
                    />

                    <button id="button_cancelar" name="action_devolver" string="Devolver" class="btn-primary" states="borrador,aprobado,radicado"
                        confirm="¿Estás seguro(a) que desea devolver el requerimiento?"
                        type="object"
                    />                                                                

                    <field name="state" widget="statusbar" statusbar_visible="borrador,aprobado,radicado"/>
                </header>
                <sheet>                    
                    <div class="oe_button_box">
                        <button  class="oe_stat_button" name="attachment_tree_view" type="object" icon="fa-files-o">
                            <field string="Documentos" name="doc_count" widget="statinfo"/>
                        </button>
                    </div>                   
                    <div class="oe_title">    
                        <h1>
                            <!-- <span>Código</span>: --> 
                            <field name="name" readonly="1" attrs="{'invisible': [('state','in',('borrador','radicado'))]}"/>
                        </h1>
                    </div>                
                    <div class="oe_title pr-0">
                        <h1 class="d-flex flex-row justify-content-between">
                            <field name="titulo" class="o_task_name text-truncate" placeholder="Título del Requerimiento..." default_focus="1" />
                        </h1>
                    </div>
                    
                    <div attrs="{'invisible': [('state','in',('borrador','radicado'))]}">
                        <group>
                            <field name="project_id"/>
                            <!-- <field name="create_date"/> --> 
                            <field name="fecha_limite"/>
                        </group>
                        <br/>
                        <h2>Interesados:</h2>
                        <group>
                            <field name="director_id"/>
                            <field name="lider_id"/>
                            <field name="gestor_id"/>
                        </group>                         
                    </div>
                    
                    <notebook>
                        <page string="Descripción">
                            <field name="descripcion" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page string="Servicios">
                            <group>
                                <group>
                                    <field name="s_tarjeta_debito"/>
                                    <field name="s_tarjeta_credito"/>
                                    <field name="s_autorizador"/>
                                </group>
                                <group>
                                    <field name="s_compensacion_redes"/>
                                    <field name="s_compensacion_bpo"/>
                                    <field name="s_compensacion_entidades_financieras"/>
                                </group>                                
                            </group>
                        </page>                                                                                
                    </notebook>               
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread" options="{'post_refresh': 'recipients'}"/>
                </div>                
            </form>
        </field>
    </record>    

</odoo>
